<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drums Demo</title>
    <link rel="stylesheet" href="./stylesheets/materialize.min.css">
    <link rel="stylesheet" href="./stylesheets/drum-music-styles.css">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"
        integrity="sha256-NuCn4IvuZXdBaFKJOAcsU2Q3ZpwbdFisd5dux4jkQ5w=" crossorigin="anonymous">
</head>

<body>
    <div class="navbar">
        <nav class="black white-text">
            <div class="container">
                <div class="nav-wrapper">
                    <a href="javascript:void(0);" class="brand-logo center">
                        <img class="circle" src="./images/rock.png" width="32" height="32">
                    </a>
                    <a href="" data-target="mobile-navbar" class="sidenav-trigger white-text show-on-large right">
                        <span style="font-size: 28px;"> &#9776; </span>
                    </a>
                    <ul class="hide-on-med-and-down">
                        <li>
                            <a href="index.html">Home
                                <i class="fa fa-home"></i>
                            </a>
                        </li>
                        <li>
                            <a class="left" href="drums.html">Drums Demo
                                <i class="fa fa-music"></i>
                            </a>
                        </li>
                        <li>
                            <a href="playlist.html">Playlists
                                <i class="fa fa-server"></i>
                            </a>
                        </li>


                        <!-- Add Authentications Here -->
                        <li class="right">
                            <a href="content.html">Other Content
                                <i class="fa fa-bell-slash-o"></i>
                            </a>
                        </li>
                    </ul>

                </div>
            </div>
        </nav>
    </div>

    <ul id="mobile-navbar" class="sidenav grey lighten-2">
        <li>
            <a href="javascript:void(0);" class="sidenav-close center">
                Close X
            </a>
            <div class="user-view">
                <div class="background">
                    <img src="./images/black-and-white-carbon-close-up-close-up-2092075.jpg" alt="">
                </div>
                <a href="#">
                    <img src="./images/concert-duotone-32x32.png" alt="" class="circle">
                </a>
                <a href="">
                    <span id="user-name-display" class="white-text">User</span>
                </a>
                <span id="user-mail" class="user-mail white-text">
                    User@mailexample
                </span>
            </div>
        </li>
        <li>
            <a href="index.html">
                <i class="fa fa-home"></i>
                Home
            </a>
        </li>
        <li>
            <a href="index.html">
                <i class="fa fa-cog"></i>
                Sign In / Sign Up
            </a>
            <div class="divider blue-grey"></div>
        <li>
            <div class="subheader black-text center-align">
                LINKS
            </div>
        </li>
        <li>
            <a href="content.html" class="waves-effect">
                Content
                <i class="fa fa-gears"></i>
            </a>
        </li>
        <li>
            <a href="playlist.html" class="waves-effect">
                Playlist
                <i class="fa fa-music"></i>
            </a>
        </li>
        <li>
            <a href="drums.html" class="waves-effect">
                Drums Demo
                <i class="fa fa-gears"></i>
            </a>
        </li>

    </ul>

    <div class="input-container">
        <label for="">Sequence Input</label>
        <input type="text" id="drumseq" class="sequence-input">
    </div>

    <div id="particles-js">


        <button id="btn-mobile-trigger" class="mobile-keyboard-trigger btn black white-text">Trigger Mobile
            Keyboard</button>
        <button id="btn-mobile-trigger2" class="mobile-keyboard-trigger btn">Keyboard Trigger Test 2</button>

        <div id="ev-keys" class="ev-keys">

            <div id="boom-drum" data-key="65" class="key">
                <kbd>A</kbd>
                <span class="sound">clap</span>
            </div>
            <div data-key="83" class="key">
                <kbd>S</kbd>
                <span class="sound">hihat</span>
            </div>
            <div data-key="68" class="key">
                <kbd>D</kbd>
                <span class="sound">kick</span>
            </div>
            <div data-key="70" class="key">
                <kbd>F</kbd>
                <span class="sound">openhat</span>
            </div>
            <div data-key="71" class="key">
                <kbd>G</kbd>
                <span class="sound">boom</span>
            </div>
            <div data-key="72" class="key">
                <kbd>H</kbd>
                <span class="sound">ride</span>
            </div>
            <div data-key="74" class="key">
                <kbd>J</kbd>
                <span class="sound">snare</span>
            </div>
            <div data-key="75" class="key">
                <kbd>K</kbd>
                <span class="sound">tom</span>
            </div>
            <div data-key="76" class="key">
                <kbd>L</kbd>
                <span class="sound">tink</span>
            </div>


        </div>

    </div>

    <div class="container white">
        <h3 class="center">DRUM MACHINE</h3>
        <div class="row">
            <div class="col s12 m5 green">
                <h2>Music Loops</h2>
                <button id="loop-1" class="btn btn-block margin-button">loop 1</button>



            </div>
            <div class="col s12 m7 blue">
                <h3>Loop Control</h3>

                <button id="stop-button" class="btn btn-block margin-button">Stop Loops</button>
            </div>




        </div>

    </div>

    <audio data-key="65" src="sounds/clap.wav"></audio>
    <audio data-key="83" src="sounds/hihat.wav"></audio>
    <audio data-key="68" src="sounds/kick.wav"></audio>
    <audio data-key="70" src="sounds/openhat.wav"></audio>
    <audio data-key="71" src="sounds/boom.wav"></audio>
    <audio data-key="72" src="sounds/ride.wav"></audio>
    <audio data-key="74" src="sounds/snare.wav"></audio>
    <audio data-key="75" src="sounds/tom.wav"></audio>
    <audio data-key="76" src="sounds/tink.wav"></audio>


    <div class="push-opaque" style="height:300px; opacity: 0;"></div>



    <!-- UI explantion section -->
    <section class="section">


        <div class="container white">
            <h4 class="center">UI explanation</h4>
            <p id="text-body" class="ui-explanation center">
                Drum Sound Maker for desktop, does not fit with mobile
            </p>
            <div class="center" style="font-size: 18px;">When Pressing Keys at First, Sounds May take 2-3 seconds to load</div>
        </div>

    </section>


    <footer class="page-footer black white-text">
        <div class="container">
            <div class="row">
                <div class="col l6 s12">
                    <h5 class="white-text">Hello<i class="fa fa-music"></i></h5>
                    <p class="grey-text text-lighten-4">Thank You For Visiting</p>
                </div>
                <div class="col l4 offset-l2 s12">
                    <h5 class="white-text">Sitemap</h5>
                    <ul>
                        <li><a class="grey-text text-lighten-3" href="index.html">home</a></li>
                        <li><a class="grey-text text-lighten-3" href="drums.html">drums demo</a>
                        </li>
                        <li><a class="grey-text text-lighten-3" href="/instruments">/instruments/</a></li>
                        <li><a class="grey-text text-lighten-3" href="content.html">Content</a>
                        </li>
                        <li><a class="grey-text text-lighten-3" href="credits.html">Credits and
                                Attributions</a></li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="footer-copyright">
            <div class="container">
                Â© 2020 DevRespecter
                <a class="grey-text text-lighten-4 right" href="">To Top <i class="fa fa-arrow-up"></i>
                </a>
            </div>
        </div>
    </footer>


    <script src="./javascripts/jquery3.5.1-uncompressed.js"></script>
    <script src="./javascripts/materialize.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
    <script>
        particlesJS.load("particles-js", "particlesjs-config.json", function () {

            console.log("CB: found, success!");
        });
    </script>


    <script>

        $(function () {

            var globalListenBtn = document.querySelectorAll(`div[data-key]`);


            // Click Functions 
            var one = document.querySelector(`div[data-key="65"]`);

            one.onclick = function () {
                console.log("Sound One: Running");
                var oneAudio = new Audio("sounds/boom.wav");
                oneAudio.play()
            }
            var two = document.querySelector(`div[data-key="83"`);

            two.onclick = function () {
                console.log("Sound Two: Running");
                var oneAudio = new Audio("sounds/hihat.wav");
                oneAudio.play()
            }

            var soundThree = document.querySelector(`div[data-key="68"`);
            soundThree.onclick = function () {
                console.log("Sound Three: Running");
                var threeAudio = new Audio("sounds/kick.wav");
                threeAudio.play()
            }
            var soundFour = document.querySelector(`div[data-key="70"`);
            soundFour.onclick = function () {
                console.log("Sound Four: Running");
                var fourAudio = new Audio("sounds/openhat.wav");
                fourAudio.play()
            }
            var soundFive = document.querySelector(`div[data-key="71"`);
            soundFive.onclick = function () {
                console.log("Sound Five: Running");
                var fiveAudio = new Audio("sounds/boom.wav");
                fiveAudio.play()
            }
            var soundSix = document.querySelector(`div[data-key="72"`);
            soundSix.onclick = function () {
                console.log("Sound Five: Running");
                var sixAudio = new Audio("sounds/ride.wav");
                sixAudio.play()
            }
            var soundSeven = document.querySelector(`div[data-key="75"`);
            soundSeven.onclick = function () {
                console.log("Sound Seven: Running", Audio);
                var sevenAudio = new Audio("sounds/snare.wav");
                sevenAudio.play()
            }
            var soundEight = document.querySelector(`div[data-key="75"`);
            soundEight.onclick = function () {
                console.log("Sound 8: Running");
                var eightAudio = new Audio("sounds/tom.wav");
                eightAudio.play()
            }
            var soundNine = document.querySelector(`div[data-key="76"`);
            soundNine.onclick = function () {
                console.log("Sound 9: Running, tink.wav");
                var nineAudio = new Audio("sounds/tink.wav");
                nineAudio.play()
            }
            /*
             * sound loops section 
             * 65clap 83hihat 68kick 70openhat 71boom 72ride 74snare 75tom 76tink 
             */

            var loop_one = document.querySelector(`button#loop-1`);
            function LoopOne() {


                var audio = new Audio(),
                    i = 0;
                var playlist = new Array('sounds/boom.wav', 'sounds/boom.wav', 'sounds/snare.wav', 'sounds/boom.wav', 'sounds/boom.wav', 'sounds/snare.wav', 'sounds/snare.wav');

                audio.addEventListener('ended', function () {
                    i = ++i < playlist.length ? i : 0;
                    console.log("testing:", i)
                    audio.src = playlist[i];
                    audio.play();
                }, true);
                audio.volume = 0.8;

                audio.src = playlist[0];
                audio.play();
                audio.currentTime = 0;
                audio.loop = false;
                // loop stopper, has to be within function to recognize audio variable 
                var audio_stop_btn = document.getElementById("stop-button");
                audio_stop_btn.onclick = function () {


                    setTimeout(function () {
                        console.log("clicked");
                        audio.loop = false;
                        // audio.currentSrc = "sounds/ride.wav"; 
                        audio.pause();
                        console.log("audio stopped");
                    },
                        1000);
                }
                // End loop one 
            }

            loop_one.addEventListener("click", LoopOne);

            function playSound(e) {

                console.log("test:", e);

                console.log("test obj difference:", audio)

                var audio = document.querySelector(`audio[data-key="${e.keyCode}"]`);

                var audioKey = document.querySelector(`div.key[data-key="${e.keyCode}"]`);

                //   var cymbalDecay, cymbalAttack; 

                if (!audio) {
                    return;
                }
                audio.currentTime = 0;
                audio.play()
                audioKey.classList.add('playing');

            }

            function removeTransition(e) {
                if (e.propertyName !== "transform") {
                    return;
                }
                console.log(this);
                this.classList.remove("playing");
            }

            var allKeys = document.querySelectorAll(".key");
            var allKeysTwo = document.querySelectorAll(`div.key`);

            allKeys.forEach(function (audioKey) {
                audioKey.addEventListener("transitionend", removeTransition);
            });

            window.addEventListener("keydown", playSound)


        });
    </script>
    <script>
        $(document).ready(function () {
            $(".sidenav").sidenav({
                edge: "right",
                draggable: true,
                inDuration: 375
            })
        })

    </script>
</body>

</html>